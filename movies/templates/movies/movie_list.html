{% extends 'base.html' %}
{% block title %}Keşfet{% endblock %}
{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Popüler Filmler</h2>
    <form method="GET" class="mb-4 text-center">
        <select name="genre_id" class="form-select mx-auto" style="max-width: 300px;" onchange="this.form.submit()">
            <option value="">Tüm Türler</option>
            {% for genre in genres %}
                <option value="{{ genre.id }}" {% if genre.id == selected_genre %}selected{% endif %}>{{ genre.name }}</option>
            {% endfor %}
        </select>
    </form>

    <div class="row">
        {% if movies %}
            {% for movie in movies %}
                <div class="col-md-3 mb-4">
                    <div class="blur-container text-center p-3 h-100">
                        <a href="{% url 'movie_detail' movie.id %}" class="text-decoration-none text-white">
                            <img src="https://image.tmdb.org/t/p/w500{{ movie.poster_path }}" alt="{{ movie.title }}" class="img-fluid rounded mb-2" style="max-height: 250px; object-fit: cover;">
                            <h5>{{ movie.title }}</h5>
                            <p><small>Rating: {{ movie.vote_average }}</small></p>
                        </a>
                        <div class="mt-2">
                            {% for gid in movie.genre_ids %}
                                {% for genre in genres %}
                                    {% if genre.id == gid %}
                                        <span class="badge bg-light text-dark me-1">{{ genre.name }}</span>
                                    {% endif %}
                                {% endfor %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="text-center text-white">Bu türde film bulunamadı.</p>
        {% endif %}
    </div>
</div>
{% endblock %}